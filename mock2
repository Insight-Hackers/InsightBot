import random
import uuid
from datetime import timedelta
import psycopg2
from datetime import datetime
def get_db_connection():
    
    
    return psycopg2.connect(
        dbname="postgres",
        user="postgres.apphxbmngxlclxromyvt",
        password="insightbot2025",
        host="aws-0-eu-north-1.pooler.supabase.com",
        port="6543"
    )

def insert_slack_messages(conn):
    messages = [
        # ×‘×§×©×•×ª ×¢×–×¨×”
        ("meitav.bin@gmail.com", "××™×©×”×• ×™×›×•×œ ×œ×‘×“×•×§ ×œ××” ×”Ö¾endpoint ×©×œ /checkout ××—×–×™×¨ 500?"),
        ("y7697086@gmail.com", "×× ×™ × ×ª×§×¢ ×›×œ ×¤×¢× ×¢×œ ×˜×¡×˜×™× ×©×œ ××•×“×•×œ ×”×–×× ×•×ª â€“ ×™×© ×œ××™×©×”×• ×–××Ÿ ×œ×”×¦×™×¥?"),
        ("ayala62005@gmail.com", "×œ× ××¦×œ×™×—×” ×œ×‘× ×•×ª ××ª ×”×¤×¨×•×™×§×˜ ××§×•××™×ª, ×–×” ×›×•×ª×‘ ×œ×™ 'Module not found: utils/db' â€“ ××•×›×¨ ×œ×›×?"),
        ("aditoubin@gmail.com", "×œ××™×©×”×• ×™×© ×’×™×©×” ×œÖ¾Sentry? ×¦×¨×™×š ×œ×‘×“×•×§ ×©×’×™××” ×©××•×¤×™×¢×” ×¨×§ ×‘×¤×¨×•×“×§×©×Ÿ"),
        ("yafit3278@gmail.com", "××™×š ×¢×©×™×ª× ××ª ×”Ö¾mock ×œÖ¾Stripe ×‘×¤×¢× ×”×§×•×“××ª? ×œ× ×¢×•×‘×“ ×œ×™ ×¢× Jest"),
        
        # ×ª×’×•×‘×•×ª ×œ×¢×–×¨×”
        ("avitalhoyzer@gmail.com", "×›×Ÿ ×××™×ª×‘, ×× ×™ ××‘×“×•×§ ××ª ×”Ö¾logs ×‘Ö¾backend"),
        ("efrat.wilinger@gmail.com", "×™×“×•×¢, ×–×” ×§×•×¨×” ×’× ×œ×™ ×‘×˜×¡×˜×™× â€“ ×ª× ×¡×” ×œ× ×§×•×ª ×§××© ×©×œ pytest"),
        ("yafit3278@gmail.com", "× ×¨××” ×œ×™ ×©×–×” ×§×•×¨×” ×‘×’×œ×œ import ×›×¤×•×œ â€“ ×× ×™ ××©×œ×— ×“×•×’××”"),
        ("meitav.bin@gmail.com", "×©×œ×—×ª×™ ×œ×š invite ×œ×’×™×©×” ×œÖ¾Sentry ×¢×›×©×™×•"),
        ("aditoubin@gmail.com", "××¦××ª×™ ××ª ×”×§×•×‘×¥ ×©×œ ×”Ö¾mock â€“ ××©×œ×— ×œ×š ×‘Ö¾Slack ×¤×¨×˜×™"),

        # ×”×•×“×¢×•×ª ×¦×•×•×ª ×¨×’×™×œ×•×ª
        ("efrat.wilinger@gmail.com", "××™×©×”×• ×¨××” ××ª ×”×§×¨×™×¡×” ×‘×œ×•×’×™×Ÿ ××—×¨×™ ×”×©×“×¨×•×’?"),
        ("yafit3278@gmail.com", "×›×Ÿ, ×œ×“×¢×ª×™ ×–×” ×§×©×•×¨ ×œ××—×™×§×ª ×”×¢×•×’×™×™×” ×©×œ ×”×¡×©×Ÿ"),
        ("meitav.bin@gmail.com", "×× ×™ ×‘×•×“×§ ××ª ×–×” ×¢×›×©×™×• ×¢×œ ×”×¡×‘×™×‘×ª dev ×©×œ×™"),
        ("aditoubin@gmail.com", "× ×¨××” ×©×–×” × ×›× ×¡ ×¢× ×”Ö¾PR ×©×œ ××ª××•×œ"),
        ("avitalhoyzer@gmail.com", "×”×× ×–×” ××•×¤×™×¢ ×’× ×‘×¡×˜×™×™×’'×™× ×’ ××• ×¨×§ ×‘×¤×¨×•×“×§×©×Ÿ?"),
        ("efrat.wilinger@gmail.com", "× ×¨××” ×©×‘×©× ×™×”×, ×™×© ×œ×•×’ ×¢× NullPointer ×‘Ö¾auth"),
        ("yafit3278@gmail.com", "× × ×¡×” ×œ×”×—×–×™×¨ ××ª ×”×©×•×¨×” ×©×”×•×¡×¨×” ×‘×˜×¢×•×ª"),
        ("ayala62005@gmail.com", "×¢×“×›× ×ª×™ ××ª ×”Ö¾CI, ×©×™×‘×“×•×§ ××ª ×”×˜×¡×˜×™× ×‘×¨×¦×£"),
        ("y7697086@gmail.com", "×©×œ×—×ª×™ commit ×¢× hotfix â€“ ×ª×¨××• ×× ×–×” ×¤×•×ª×¨"),
        ("meitav.bin@gmail.com", "×‘×“×§×ª×™ ×¢×›×©×™×• â€“ × ×¨××” ×©×–×” ×ª×•×§×Ÿ ğŸ‰"),
        ("avitalhoyzer@gmail.com", "×˜×™×¤×œ×ª×™ ×‘×–×” ××ª××•×œ ×‘×œ×™×œ×” â€“ CSS ×§×™×‘×œ ×©×™× ×•×™ ×§×˜×Ÿ"),
        ("efrat.wilinger@gmail.com", "×˜×•×‘, ××™×©×”×• ×¨××” ××ª ×”Ö¾PR ×©×œ ××¤×¨×ª?"),
        ("yafit3278@gmail.com", "×× ×™ ×¢×•×©×” review ×¢×›×©×™×•"),
        ("meitav.bin@gmail.com", "× ×¨××” ×˜×•×‘, ×¨×§ ×œ×”×¢×™×£ ××ª ×”×§×•× ×¡×•×œ×•×ª"),
        ("efrat.wilinger@gmail.com", "×¡×‘×‘×”, ××˜×¤×œ ×‘×–×”"),
        ("aditoubin@gmail.com", "×™××œ×œ×” ×©×‘×•×¢ ×˜×•×‘ ×œ×›×•×œ×Ÿ âœ¨"),
    ]
    with conn.cursor() as cur:
        for i, (user, text) in enumerate(messages):
            cur.execute("""
                INSERT INTO slack_messages_raw (id, channel_id, user_id, text, ts, thread_ts, raw, event_type, parent_id, is_list, list_items, num_list_items)
                VALUES (%s, 'dev', %s, %s, %s, NULL, '{}'::jsonb, 'message', NULL, FALSE, NULL, NULL)
            """, (gen_id(), user, text, int(today.timestamp())))
    conn.commit()

    
def gen_id():
    return str(uuid.uuid4())

today = datetime(2025, 6, 10)

def run_full_simulation():
    conn = get_db_connection()
    try:
        insert_slack_messages(conn)
        print("âœ… Slack messages inserted.")
    
    finally:
        conn.close()
        

if __name__ == "__main__":
    run_full_simulation()
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    

    

# ---------- Slack messages (user_1 + user_2) ----------
def insert_slack_messages(conn):
   
    with conn.cursor() as cur:
        for user_id, text in messages:
            cur.execute("""
                INSERT INTO slack_messages_raw (id, channel_id, user_id, text, ts, thread_ts, raw, event_type, parent_id, is_list, list_items, num_list_items)
                VALUES (%s, 'dev', %s, %s, %s, NULL, '{}'::jsonb, 'message', NULL, FALSE, NULL, NULL)
            """, (gen_id(), user_id, text, int(today.timestamp())))
    conn.commit()


# ---------- ×“×™×•×•×— Slack (user_7) ----------
def insert_slack_report(conn):
    with conn.cursor() as cur:
        cur.execute("""
            INSERT INTO slack_reports_raw (id, user_id, text, ts, channel_id, report_type, status)
            VALUES (%s, %s, %s, %s, %s, %s, %s)
        """, (
            gen_id(), "Meitav", "×¡×™×™××ª×™ ××ª ×ª×™×§×•×Ÿ ×”×‘×¢×™×” ×‘×ª×¦×•×’×”", today,
            "dev", "progress", "done"
        ))
    conn.commit()

